id = 1:3,
long = c(4.85558, 4.89904, 4.91073),
lat = c(52.39707, 52.36612, 52.36255)
)
# convert to sf with the same crs
pnts_sf <- st_as_sf(pnts, crs = 7415L, coords = c("long", "lat"))
st_distance(pnts_sf, area)
pnts_sf %>%
mutate(
distance = st_distance(area, by_element = TRUE),
distance2 = st_distance(area, by_element = FALSE),
distance3 = st_distance(geometry, area, by_element = TRUE)
)
all.equal(st_crs(pnts_sf),st_crs(area))
st_distance(pnts_sf, area)
st_distance(spTa.proj, Peru.proj)
PERU_SP
str(Peru.proj)
area = st_as_sfc(PERU_SP, crs = "+proj=longlat")
spTa.proj
Peru.proj
spTa.proj
Peru.proj
area
plot(area)
lon = c(-74,-80)
lat = c(-4,-7)
temp = data.frame(lon = lon, lat = lat)
posiciones = temp[,c("lon", "lat")]
pnts_sf <- st_as_sf(posiciones, crs = "+proj=longlat", coords = c("lon", "lat"))
distance = st_distance(pnts_sf, area)
st_distance(pnts_sf, area)
pnts_sf
points(pnts_sf)
all.equal(st_crs(pnts_sf),st_crs(area))
lon = c(-74,-80)
lat = c(-4,-7)
temp = data.frame(lon = lon, lat = lat)
posiciones = temp[,c("long", "lat")]
lon = c(-74,-80)
lat = c(-4,-7)
temp = data.frame(long = lon, lat = lat)
posiciones = temp[,c("long", "lat")]
area    <- st_as_sfc(PERU_SP, crs = "+proj=longlat")
pnts_sf <- st_as_sf(posiciones, crs = "+proj=longlat", coords = c("long", "lat"))
all.equal(st_crs(pnts_sf),st_crs(area))
str(area)
Peru              = as(PERU_SP, "SpatialPolygons")
area    <- st_as_sfc(Peru, crs = "+proj=longlat")
pnts_sf <- st_as_sf(posiciones, crs = "+proj=longlat", coords = c("long", "lat"))
all.equal(st_crs(pnts_sf),st_crs(area))
pnts_sf$geometry
area
area    <- st_as_sfc(Peru, crs = "+proj=longlat")
area
Peru
PERU_SP
#- Read shapefile of Peru
Peru              = as(PERU_SP, "SpatialPolygons")
proj4string(Peru) = CRS("+proj=longlat")
Peru    <- st_as_sfc(Peru, crs = "+proj=longlat")
Peru
pnts_sf <- st_as_sf(posiciones, crs = "+proj=longlat", coords = c("long", "lat"))
all.equal(st_crs(pnts_sf),st_crs(area))
distance = st_distance(pnts_sf, area)
Peru              = as(PERU_SP, "SpatialPolygons")
proj4string(Peru) = CRS("+proj=longlat")
Peru.proj         = spTransform(Peru, CRS("+proj=utm +zone=18 ellips=WGS84"))
Peru              = as(PERU_SP, "SpatialPolygons")
Peru    <- st_as_sfc(Peru, crs = "+proj=longlat")
Peru
Peru
pnts_sf
CRS(Peru)
names(Peru)
str(Peru)
Peru              = as(PERU_SP, "SpatialPolygons")
proj4string(Peru) = CRS("+proj=longlat")
Peru.proj         = spTransform(Peru, CRS("+proj=utm +zone=18 ellips=WGS84"))
Peru              = as(PERU_SP, "SpatialPolygons")
proj4string(Peru) = CRS("+proj=longlat")
Peru.proj         = spTransform(Peru, CRS("+proj=longlat"))
Peru              = as(PERU_SP, "SpatialPolygons")
Peru    <- st_as_sfc(Peru, crs = "+proj=longlat")
Peru
pnts_sf <- st_as_sf(posiciones, crs = "+proj=longlat", coords = c("long", "lat"))
all.equal(st_crs(pnts_sf),st_crs(area))
Peru
pnts_sf
PERU_SP
Peru              = as(PERU_SP, "SpatialPolygons")
proj4string(Peru) = CRS("+proj=longlat")
all.equal(st_crs(pnts_sf),st_crs(Peru))
distance = st_distance(pnts_sf, Peru)
Peru              = as(PERU_SP, "SpatialPolygons")
proj4string(Peru) = CRS("+proj=longlat")
Peru
pnts_sf <- st_as_sf(posiciones, crs = "+proj=longlat", coords = c("long", "lat"))
all.equal(st_crs(pnts_sf),st_crs(Peru))
distance = st_distance(pnts_sf, Peru)
lon = c(-74,-80)
lat = c(-4,-7)
temp = data.frame(long = lon, lat = lat)
posiciones = temp[,c("long", "lat")]
pnts_sf <- st_as_sf(posiciones, crs = "+proj=longlat", coords = c("long", "lat"))
pnts_sf
PERU_SP
Peru              = as(PERU_SP, "SpatialPolygons")
Peru              <- st_as_sfc(Peru, crs = "+proj=longlat")
Peru
proj4string(Peru) = CRS("+proj=longlat")
Peru              <- sfc_POLYGON(Peru, crs = "+proj=longlat")
proj4string(Peru) = CRS("+proj=longlat")
pnts_sf <- st_as_sf(posiciones, crs = "+proj=longlat", coords = c("long", "lat"))
all.equal(st_crs(pnts_sf),st_crs(Peru))
Peru
Peru
PERU_SP
Coord(PERU_SP)
PERU_SP$ID
summary(PERU_SP)
Peru.proj
Peru              = as(PERU_SP, "SpatialPolygons")
proj4string(Peru) = CRS("+proj=longlat")
Peru.proj         = spTransform(Peru, CRS("+proj=utm +zone=18 ellips=WGS84"))
area <- st_as_sfc(Peru.proj, crs = "+proj=longlat")
area
pnts_sf <- st_as_sf(posiciones, crs = "+proj=longlat", coords = c("long", "lat"))
all.equal(st_crs(pnts_sf),st_crs(Peru))
distance = st_distance(pnts_sf, Peru)
pnts_sf <- st_as_sf(posiciones, crs = "+proj=utm +zone=18 ellips=WGS84", coords = c("long", "lat"))
all.equal(st_crs(pnts_sf),st_crs(Peru))
distance = st_distance(pnts_sf, Peru)
st_crs(pnts_sf)
st_crs(Peru)
area
pnts_sf
Peru              = as(PERU_SP, "SpatialPolygons")
Peru.proj         = spTransform(Peru, CRS("+proj=utm +zone=18 ellips=WGS84"))
proj4string(Peru) = CRS("+proj=longlat")
Peru.proj         = spTransform(Peru, CRS("+proj=utm +zone=18 ellips=WGS84"))
Peru.proj
area <- st_as_sfc(Peru.proj)#, crs = "+proj=longlat")
area
lon = c(-74,-80)
lat = c(-4,-7)
temp = data.frame(long = lon, lat = lat)
posiciones = temp[,c("long", "lat")]
pnts_sf <- st_as_sf(posiciones, crs = "+proj=utm +zone=18 ellips=WGS84", coords = c("long", "lat"))
pnts_sf
pnts_sf <- st_as_sf(posiciones, crs = "+proj=utm +zone=18 +datum=WGS84 +units=m +no_defs", coords = c("long", "lat"))
all.equal(st_crs(pnts_sf),st_crs(Peru))
distance = st_distance(pnts_sf, Peru)
area
pnts_sf
library("tidyverse")
library("sf")
# area of interest
area <-
"POLYGON ((121863.900623145 486546.136633659, 121830.369032584 486624.24942906, 121742.202408334 486680.476675484, 121626.493982203 486692.384434804, 121415.359596921 486693.816446951, 121116.219703244 486773.748535465, 120965.69439283 486674.642759986, 121168.798757601 486495.217550029, 121542.879304342 486414.780364836, 121870.487595417 486512.71203006, 121863.900623145 486546.136633659))"
# convert to sf and project on a projected coord system
area <- st_as_sfc(area, crs = 7415L)
# points with long/lat coords
pnts <-
data.frame(
id = 1:3,
long = c(4.85558, 4.89904, 4.91073),
lat = c(52.39707, 52.36612, 52.36255)
)
# convert to sf with the same crs
pnts_sf <- st_as_sf(pnts, crs = 7415L, coords = c("long", "lat"))
pnts_sf %>%
mutate(
distance = st_distance(area, by_element = TRUE),
distance2 = st_distance(area, by_element = FALSE),
distance3 = st_distance(geometry, area, by_element = TRUE)
)
pnts_sf
area
pnts_sf
area
Peru              = as(PERU_SP, "SpatialPolygons")
proj4string(Peru) = CRS("+proj=longlat")
Peru.proj         = spTransform(Peru, CRS("+proj=utm +zone=18 ellips=WGS84"))
area <- st_as_sfc(Peru.proj)#, crs = "+proj=longlat")
area
lon = c(-74,-80)
lat = c(-4,-7)
temp = data.frame(long = lon, lat = lat)
posiciones = temp[,c("long", "lat")]
pnts_sf <- st_as_sf(posiciones, crs = "+proj=utm +zone=18 +datum=WGS84 +units=m +no_defs", coords = c("long", "lat"))
pnts_sf
temp = data.frame(id = 1:length(long), long = lon, lat = lat)
posiciones = temp[,c("long", "lat")]
temp = data.frame(id = 1:length(lon), long = lon, lat = lat)
posiciones = temp[,c("long", "lat")]
posiciones
pnts_sf <- st_as_sf(posiciones, crs = "+proj=longlat", coords = c("long", "lat"))
pnts_sf
pnts <-
data.frame(
id = 1:3,
long = c(4.85558, 4.89904, 4.91073),
lat = c(52.39707, 52.36612, 52.36255)
)
# convert to sf with the same crs
pnts_sf <- st_as_sf(pnts, crs = 7415L, coords = c("long", "lat"))
pnts
# convert to sf with the same crs
pnts_sf <- st_as_sf(pnts, crs = 7415L, coords = c("long", "lat"))
pnts_sf
lon = c(-74,-80)
lat = c(-4,-7)
temp = data.frame(id = 1:length(lon), long = lon, lat = lat)
pnts_sf <- st_as_sf(temp, crs = "+proj=longlat", coords = c("long", "lat"))
pnts_sf
all.equal(st_crs(pnts_sf),st_crs(Peru))
area <-
"POLYGON ((121863.900623145 486546.136633659, 121830.369032584 486624.24942906, 121742.202408334 486680.476675484, 121626.493982203 486692.384434804, 121415.359596921 486693.816446951, 121116.219703244 486773.748535465, 120965.69439283 486674.642759986, 121168.798757601 486495.217550029, 121542.879304342 486414.780364836, 121870.487595417 486512.71203006, 121863.900623145 486546.136633659))"
# convert to sf and project on a projected coord system
area <- st_as_sfc(area, crs = 7415L)
# points with long/lat coords
pnts <-
data.frame(
id = 1:3,
long = c(4.85558, 4.89904, 4.91073),
lat = c(52.39707, 52.36612, 52.36255)
)
# convert to sf with the same crs
pnts_sf <- st_as_sf(pnts, crs = 7415L, coords = c("long", "lat"))
pnts_sf %>%
mutate(
distance = st_distance(area, by_element = TRUE),
distance2 = st_distance(area, by_element = FALSE),
distance3 = st_distance(geometry, area, by_element = TRUE)
)
map_dbl(pnts_geoms, st_distance, y = area)
# area of interest
area <-
"POLYGON ((121863.900623145 486546.136633659, 121830.369032584 486624.24942906, 121742.202408334 486680.476675484, 121626.493982203 486692.384434804, 121415.359596921 486693.816446951, 121116.219703244 486773.748535465, 120965.69439283 486674.642759986, 121168.798757601 486495.217550029, 121542.879304342 486414.780364836, 121870.487595417 486512.71203006, 121863.900623145 486546.136633659))"
# convert to sf and project on a projected coord system
area <- st_as_sfc(area, crs = 7415L)
# points with long/lat coords
pnts <-
data.frame(
id = 1:3,
long = c(4.85558, 4.89904, 4.91073),
lat = c(52.39707, 52.36612, 52.36255)
)
# convert to sf with the same crs
pnts_sf <- st_as_sf(pnts, crs = 7415L, coords = c("long", "lat"))
all.equal(st_crs(pnts_sf),st_crs(area))
st_crs(pnts_sf)
pnts_sf
area
spTa.proj
pnts_sf
Peru
Peru
st_crs(pnts_sf)
st_crs(Peru)
all.equal(st_crs(pnts_sf),st_crs(Peru))
distance = st_distance(pnts_sf, Peru)
PERU_SP
plot(# this part was wrong, crs was supposed to be the one they were
# originally coded in
pnts_sf <- st_as_sf(pnts, crs = 4326L, coords = c("long", "lat"))
# then apply the transformation to another crs
pnts_sf <- st_transform(pnts_sf, crs = 7415L)
plot(PERU_SP)
Peru              = as(PERU_SP, "SpatialPolygons")
proj4string(Peru) = CRS("+proj=longlat")
Peru.proj         = spTransform(Peru, CRS("+proj=utm +zone=18 ellips=WGS84"))
Peru.proj
area <- st_as_sfc(Peru.proj)#, crs = "+proj=longlat")
area
lon = c(-74,-80)
lat = c(-4,-7)
temp = data.frame(long = lon, lat = lat)
temp
temp = data.frame(id = 1:length(lon),long = lon, lat = lat)
temp
pnts_sf <- st_as_sf(posiciones, crs = "+proj=utm +zone=18 +datum=WGS84 +units=m +no_defs", coords = c("long", "lat"))
pnts_sf
area
all.equal(st_crs(pnts_sf),st_crs(Peru))
# area of interest
area <-
"POLYGON ((121863.900623145 486546.136633659, 121830.369032584 486624.24942906, 121742.202408334 486680.476675484, 121626.493982203 486692.384434804, 121415.359596921 486693.816446951, 121116.219703244 486773.748535465, 120965.69439283 486674.642759986, 121168.798757601 486495.217550029, 121542.879304342 486414.780364836, 121870.487595417 486512.71203006, 121863.900623145 486546.136633659))"
# convert to sf and project on a projected coord system
area <- st_as_sfc(area, crs = 7415L)
area
# points with long/lat coords
pnts <-
data.frame(
id = 1:3,
long = c(4.85558, 4.89904, 4.91073),
lat = c(52.39707, 52.36612, 52.36255)
)
# points with long/lat coords
pnts <-
data.frame(
id = 1:3,
long = c(4.85558, 4.89904, 4.91073),
lat = c(52.39707, 52.36612, 52.36255)
)
pnts
all.equal(st_crs(pnts_sf),st_crs(area))
posiciones
PERU_SP
library("sf")
# area of interest
area <-
"POLYGON ((121863.900623145 486546.136633659, 121830.369032584 486624.24942906, 121742.202408334 486680.476675484, 121626.493982203 486692.384434804, 121415.359596921 486693.816446951, 121116.219703244 486773.748535465, 120965.69439283 486674.642759986, 121168.798757601 486495.217550029, 121542.879304342 486414.780364836, 121870.487595417 486512.71203006, 121863.900623145 486546.136633659))"
# convert to sf and project on a projected coord system
area <- st_as_sfc(area, crs = 7415L)
# points with long/lat coords
pnts <-
data.frame(
id = 1:3,
long = c(4.85558, 4.89904, 4.91073),
lat = c(52.39707, 52.36612, 52.36255)
)
# convert to sf with the same crs
pnts_sf <- st_as_sf(pnts, crs = 7415L, coords = c("long", "lat"))
# check if crs are equal
all.equal(st_crs(pnts_sf),st_crs(area))
PERU_SP
wkt(PERU_SP)
area
pnts_sf
st_crs(area)
wkt(area)
sfc_POLYGON(area)
wkt(PERU_SP) =
area <- PERU_SP
##******************************************************
estima_dc2(lon = -75,lat = -3)
##******************************************************
require(vmsR)
estima_dc2(lon = -75,lat = -3)
##******************************************************
require(vmsR)
estima_dc2(lon = -75,lat = -3)
estima_dc2(lon = -75,lat = -6)
estima_dc2(lon = -75,lat = -14)
estima_dc2(lon = -85,lat = -14)
pnts <-
data.frame(
id = 1:3,
long = c(-74.85558, -74.89904, -74.91073),
lat = c(-4.39707, -5.36612, -6.36255)
)
# convert to sf and project on a projected coord system
area <- st_as_sfc(PERU_SP, crs = 7415L)
area
Polygon(PERU_SP)
# convert to sf and project on a projected coord system
area <- st_as_sfc(Polygon(PERU_SP), crs = 7415L)
as(PERU_SP, "SpatialPolygons")
lon = c(-78.345,-81.3343,-87.5654)
lat = c(-12.345,-15.4335,-9.32435)
estima_dc2(lon = lon, lat = lat)
# convert to sf and project on a projected coord system
area <- st_as_sfc(PERU_SP, crs = 4326L)
area = st_set_crs(area, 4326L)
# points with long/lat coords
pnts <-
data.frame(
long = lon,
lat = lat
)
# convert to sf with the same crs
pnts_sf <- st_as_sf(pnts, crs = 4326L, coords = c("long", "lat"))
pnts_sf = st_set_crs(pnts_sf, 4326L)
# check if crs are equal
all.equal(st_crs(pnts_sf),st_crs(area))
st_distance(pnts_sf, area)*0.000539957
PERU_SP
output = as.numeric(st_distance(pnts_sf, area)*0.000539957)
output
estima_dc3 <- function(lon, lat){
# convert to sf and project on a projected coord system
area <- st_as_sfc(PERU_SP, crs = 4326L)
area <- st_set_crs(area, 4326L)
# points with long/lat coords
pnts <-
data.frame(
long = lon,
lat = lat
)
# convert to sf with the same crs
pnts_sf <- st_as_sf(pnts, crs = 4326L, coords = c("long", "lat"))
pnts_sf = st_set_crs(pnts_sf, 4326L)
# check if crs are equal
all.equal(st_crs(pnts_sf),st_crs(area))
output = as.numeric(st_distance(pnts_sf, area)*0.000539957)
return(output)
estima_dc3(lon = lon, lat = lat)
require(sf)
# convert to sf and project on a projected coord system
area <- st_as_sfc(PERU_SP, crs = 4326L)
area <- st_set_crs(area, 4326L)
# points with long/lat coords
pnts <-
data.frame(
long = lon,
lat = lat
)
# convert to sf with the same crs
pnts_sf <- st_as_sf(pnts, crs = 4326L, coords = c("long", "lat"))
pnts_sf = st_set_crs(pnts_sf, 4326L)
# check if crs are equal
all.equal(st_crs(pnts_sf),st_crs(area))
output = as.numeric(st_distance(pnts_sf, area)*0.000539957)
estima_dc3 <- function(lon, lat){
require(sf)
# convert to sf and project on a projected coord system
area <- st_as_sfc(PERU_SP, crs = 4326L)
area <- st_set_crs(area, 4326L)
# points with long/lat coords
pnts <-
data.frame(
long = lon,
lat = lat
)
# convert to sf with the same crs
pnts_sf <- st_as_sf(pnts, crs = 4326L, coords = c("long", "lat"))
pnts_sf = st_set_crs(pnts_sf, 4326L)
# check if crs are equal
all.equal(st_crs(pnts_sf),st_crs(area))
output = as.numeric(st_distance(pnts_sf, area)*0.000539957)
return(output)
}
estima_dc3(lon = lon, lat = lat)
estima_dc2(lon = lon, lat = lat)
rnorm(500000, mean = -84, sd = 2)
estima_dc3
estima_dc2
estima_dc3 <- function(lon, lat){
require(sf)
# convert to sf and project on a projected coord system
area <- st_as_sfc(PERU_SP, crs = 4326L)
area <- st_set_crs(area, 4326L)
# points with long/lat coords
pnts <-
data.frame(
long = lon,
lat = lat
)
# convert to sf with the same crs
pnts_sf <- st_as_sf(pnts, crs = 4326L, coords = c("long", "lat"))
pnts_sf = st_set_crs(pnts_sf, 4326L)
# check if crs are equal
all.equal(st_crs(pnts_sf),st_crs(area))
output = as.numeric(st_distance(pnts_sf, area)*0.000539957)
return(output)
}
lon = rnorm(500000, mean = -84, sd = 2)
lat = rnorm(500000, mean = -14, sd = 2)
library(tictoc)
library(tictoc)
tic()
estima_dc2(lon = lon, lat = lat)
toc()
tic()
estima_dc3(lon = lon, lat = lat)
toc()
tic()
dd = estima_dc2(lon = lon, lat = lat)
toc()
tic()
dd2 = estima_dc3(lon = lon, lat = lat)
toc()
plot(dd, dd2)
library(vmsR)
warnings()
dist_cost <- function(lon, lat, polygon = NULL, area =NULL){
require(sf)
# convert to sf and project on a projected coord system
if(is.null(polygon)){
area <- st_as_sfc(PERU_SP, crs = 4326L)
area <- st_set_crs(area, 4326L)
# points with long/lat coords
pnts <-
data.frame(
long = lon,
lat = lat
)
# convert to sf with the same crs
pnts_sf <- st_as_sf(pnts, crs = 4326L, coords = c("long", "lat"))
pnts_sf = st_set_crs(pnts_sf, 4326L)
}else{
area <- st_as_sfc(PERU_SP, crs = area)
area <- st_set_crs(area, area)
# points with long/lat coords
pnts <-
data.frame(
long = lon,
lat = lat
)
# convert to sf with the same crs
pnts_sf <- st_as_sf(pnts, crs = area, coords = c("long", "lat"))
pnts_sf = st_set_crs(pnts_sf, area)
}
# check if crs are equal
all.equal(st_crs(pnts_sf),st_crs(area))
output = as.numeric(st_distance(pnts_sf, area)*0.000539957)
return(output)
}
library(vmsR)
require(vmsR)
