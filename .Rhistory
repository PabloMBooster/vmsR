text(base_barco$Lon, base_barco$Lat, labels = round(c1), cex = 0.4, col = 1)
text(base_barco$Lon, base_barco$Lat, labels = round(c1), cex = 0.6, col = 1)
c1
text(base_barco$Lon, base_barco$Lat, labels = round(c2), cex = 0.6, col = 1)
c1
c2
round(c2)
plot(base_barco$Lon, base_barco$Lat, col = "white")
Arrows(x0 = base_barco$Lon[-length(base_barco$Lon)],
y0 = base_barco$Lat[-length(base_barco$Lon)],
x1 = base_barco$Lon[-1],
y1 = base_barco$Lat[-1], arr.length = 0.2, col = 3)
text(base_barco$Lon, base_barco$Lat, labels = round(c2), cex = 0.6, col = 1)
plot(base_barco$Lon, base_barco$Lat, col = "white")
Arrows(x0 = base_barco$Lon[-length(base_barco$Lon)],
y0 = base_barco$Lat[-length(base_barco$Lon)],
x1 = base_barco$Lon[-1],
y1 = base_barco$Lat[-1], arr.length = 0.2, col = 3)
text(base_barco$Lon, base_barco$Lat, pos = 2,
labels = round(c2), cex = 0.6, col = 1)
get_course
calculate_course
calculate_course
head(base_barco)
rumbo <- function(lon, lat, dist){
vectorRumbo <- NULL
vectorRumbo[1] <- NA
for(i in 2:length(lon)){
rad <- pi/180
x2 <-  lon[i]*rad
y2 <-  lat[i]*rad
x1 <-  lon[i-1]*rad
y1 <-  lat[i-1]*rad
d1 <-  dist[i-1]
theta <- (180/pi)*acos((sin(y2)-sin(y1)*cos(d1))/(cos(y1)*sen(d1)))
diffLon <- x1-x2
if(diffLon <= 0){
theta = theta
}else{
theta = 360-theta
}
}
return(theta)}
c3 <- rumbo(lon = base_barco$Lon, lat = base_barco$Lat, dist = base_barco$Dist_Emisiones)
rumbo <- function(lon, lat, dist){
vectorRumbo <- NULL
vectorRumbo[1] <- NA
for(i in 2:length(lon)){
rad <- pi/180
x2 <-  lon[i]*rad
y2 <-  lat[i]*rad
x1 <-  lon[i-1]*rad
y1 <-  lat[i-1]*rad
d1 <-  dist[i-1]
theta <- (180/pi)*acos((sin(y2)-sin(y1)*cos(d1))/(cos(y1)*sen(d1)))
diffLon <- x1-x2
if(diffLon <= 0){
theta = theta
}else{
theta = 360-theta
}
}
return(theta)}
rumbo <- function(lon, lat, dist){
vectorRumbo <- NULL
vectorRumbo[1] <- NA
for(i in 2:length(lon)){
rad <- pi/180
x2 <-  lon[i]*rad
y2 <-  lat[i]*rad
x1 <-  lon[i-1]*rad
y1 <-  lat[i-1]*rad
d1 <-  dist[i-1]
theta <- (180/pi)*acos((sin(y2)-sin(y1)*cos(d1))/(cos(y1)*sen(d1)))
diffLon <- x1-x2
if(diffLon <= 0){
theta = theta
}else{
theta = 360-theta
}
}
return(theta)
}
c3 <- rumbo(lon = base_barco$Lon, lat = base_barco$Lat, dist = base_barco$Dist_Emisiones)
rumbo <- function(lon, lat, dist){
vectorRumbo <- NULL
vectorRumbo[1] <- NA
for(i in 2:length(lon)){
rad <- pi/180
x2 <-  lon[i]*rad
y2 <-  lat[i]*rad
x1 <-  lon[i-1]*rad
y1 <-  lat[i-1]*rad
d1 <-  dist[i-1]
theta <- (180/pi)*acos((sin(y2)-sin(y1)*cos(d1))/(cos(y1)*sin(d1)))
diffLon <- x1-x2
if(diffLon <= 0){
theta = theta
}else{
theta = 360-theta
}
}
return(theta)
}
c3 <- rumbo(lon = base_barco$Lon, lat = base_barco$Lat, dist = base_barco$Dist_Emisiones)
c3
base_barco$Dist_Emisiones
rumbo <- function(lon, lat, dist){
vectorRumbo <- NULL
vectorRumbo[1] <- NA
for(i in 2:length(lon)){
rad <- pi/180
x2 <-  lon[i]*rad
y2 <-  lat[i]*rad
x1 <-  lon[i-1]*rad
y1 <-  lat[i-1]*rad
d1 <-  dist[i-1]
theta <- (180/pi)*acos((sin(y2)-sin(y1)*cos(d1))/(cos(y1)*sin(d1)))
diffLon <- x1-x2
if(diffLon <= 0){
theta = theta
}else{
theta = 360-theta
}
vectorRumbo <- rbind(vectorRumbo, theta)
}
return(vectorRumbo)
}
c3 <- rumbo(lon = base_barco$Lon, lat = base_barco$Lat, dist = base_barco$Dist_Emisiones)
c3
vectorRumbo <- NULL
length(lon)
rumbo <- function(lon, lat, dist){
vectorRumbo <- NULL
for(i in 2:length(lon)){
rad <- pi/180
x2 <-  lon[i]*rad
y2 <-  lat[i]*rad
x1 <-  lon[i-1]*rad
y1 <-  lat[i-1]*rad
d1 <-  dist[i-1]
theta <- (180/pi)*acos((sin(y2)-sin(y1)*cos(d1))/(cos(y1)*sin(d1)))
diffLon <- x1-x2
if(diffLon <= 0){
theta = theta
}else{
theta = 360-theta
}
vectorRumbo <- rbind(vectorRumbo, theta)
}
vectorRumbo[1] <- NA
return(vectorRumbo)
}
c3 <- rumbo(lon = base_barco$Lon, lat = base_barco$Lat, dist = base_barco$Dist_Emisiones)
c2 <- calculate_course(lon = base_barco$Lon,lat = base_barco$Lat)
cbind(c2, c3)
c3
rumbo <- function(lon, lat, dist){
vectorRumbo <- NULL
for(i in 2:length(lon)){
rad <- pi/180
x2 <-  lon[i]*rad
y2 <-  lat[i]*rad
x1 <-  lon[i-1]*rad
y1 <-  lat[i-1]*rad
d1 <-  dist[i-1]
theta <- (180/pi)*acos((sin(y2)-sin(y1)*cos(d1))/(cos(y1)*sin(d1)))
diffLon <- x1-x2
if(diffLon <= 0){
theta = theta
}else{
theta = 360-theta
}
vectorRumbo <- rbind(vectorRumbo, theta)
}
vectorRumbo[1] <- NA
vectorRumbo <- as.numeric(vectorRumbo)
return(vectorRumbo)
}
cbind(2,c3)
cbind(c2,c3)
c2 <- calculate_course(lon = base_barco$Lon,lat = base_barco$Lat)
cbind(c2,c3)
rumbo <- function(lon, lat, dist){
vectorRumbo <- NULL
for(i in 2:length(lon)){
rad <- pi/180
x2 <-  lon[i]*rad
y2 <-  lat[i]*rad
x1 <-  lon[i-1]*rad
y1 <-  lat[i-1]*rad
d1 <-  dist[i-1]
theta <- (180/pi)*acos((sin(y2)-sin(y1)*cos(d1))/(cos(y1)*sin(d1)))
diffLon <- x1-x2
# if(diffLon <= 0){
#   theta = theta
# }else{
#   theta = 360-theta
# }
vectorRumbo <- rbind(vectorRumbo, theta)
}
vectorRumbo[1] <- NA
vectorRumbo <- as.numeric(vectorRumbo)
return(vectorRumbo)
}
c2 <- calculate_course(lon = base_barco$Lon,lat = base_barco$Lat)
c3 <- rumbo(lon = base_barco$Lon, lat = base_barco$Lat, dist = base_barco$Dist_Emisiones)
cbind(c2,c3)
rumbo <- function(lon, lat, dist){
vectorRumbo <- NULL
for(i in 2:length(lon)){
rad <- pi/180
x2 <-  lon[i]*rad
y2 <-  lat[i]*rad
x1 <-  lon[i-1]*rad
y1 <-  lat[i-1]*rad
d1 <-  dist[i]
theta <- (180/pi)*acos((sin(y2)-sin(y1)*cos(d1))/(cos(y1)*sin(d1)))
diffLon <- x1-x2
if(diffLon <= 0){
theta = theta
}else{
theta = 360-theta
}
vectorRumbo <- rbind(vectorRumbo, theta)
}
vectorRumbo[1] <- NA
vectorRumbo <- as.numeric(vectorRumbo)
return(vectorRumbo)
}
c2 <- calculate_course(lon = base_barco$Lon,lat = base_barco$Lat)
c3 <- rumbo(lon = base_barco$Lon, lat = base_barco$Lat, dist = base_barco$Dist_Emisiones)
cbind(c2,c3)
rumbo <- function(lon, lat, dist){
vectorRumbo <- NULL
for(i in 2:length(lon)){
rad <- pi/180
x2 <-  lon[i]*rad
y2 <-  lat[i]*rad
x1 <-  lon[i-1]*rad
y1 <-  lat[i-1]*rad
d1 <-  dist[i]
theta <- (180/pi)*acos((sin(y2)-sin(y1)*cos(d1))/(cos(y1)*sin(d1)))
diffLon <- x1-x2
if(diffLon <= 0){
theta = theta
}else{
theta = 360-theta
}
vectorRumbo <- rbind(vectorRumbo, theta)
}
vectorRumbo[1] <- NA
vectorRumbo <- as.numeric(vectorRumbo)
return(vectorRumbo)
}
c2 <- calculate_course(lon = base_barco$Lon,lat = base_barco$Lat)
c3 <- rumbo(lon = base_barco$Lon, lat = base_barco$Lat, dist = base_barco$Dist_Emisiones)
cbind(c2,c3)
rumbo <- function(lon, lat, dist){
vectorRumbo <- NULL
for(i in 2:length(lon)){
rad <- pi/180
x2 <-  lon[i]*rad
y2 <-  lat[i]*rad
x1 <-  lon[i-1]*rad
y1 <-  lat[i-1]*rad
d1 <-  dist[i]
theta <- (180/pi)*acos((sin(y2)-sin(y1)*cos(d1))/(cos(y1)*sin(d1)))
diffLon <- x1-x2
# if(diffLon <= 0){
#   theta = theta
# }else{
#   theta = 360-theta
# }
vectorRumbo <- rbind(vectorRumbo, theta)
}
vectorRumbo[1] <- NA
vectorRumbo <- as.numeric(vectorRumbo)
return(vectorRumbo)
}
c2 <- calculate_course(lon = base_barco$Lon,lat = base_barco$Lat)
c3 <- rumbo(lon = base_barco$Lon, lat = base_barco$Lat, dist = base_barco$Dist_Emisiones)
cbind(c2,c3)
calculate_course
require(SISESATools)
estimateAngle <- function(x,y){
vec_angle <- NULL
for(z in 2:(length(x)-1)){
A <- matrix(NA,nrow = 2)
B <- matrix(NA,nrow = 2)
X1 <- as.matrix(x[c(z-1,z)])
Y1 <- as.matrix(y[c(z-1,z)])
X2 <- as.matrix(x[c(z,z+1)])
Y2 <- as.matrix(y[c(z,z+1)])
A[1] <- X1[1]-X1[2]
A[2] <- Y1[1]-Y1[2]
B[1] <- X2[2]-X2[1]
B[2] <- Y2[2]-Y2[1]
angle <- equationAngle(t(A),B)
vec_angle <- rbind(vec_angle,angle)
}
return(vec_angle)
}
equationAngle
equationAngle <- function(x,y){
dot.prod <- x%*%y
norm.x <- norm(x,type="2")
norm.y <- norm(y,type="2")
theta <- acos(dot.prod / (norm.x * norm.y))*180/pi
return(theta)
}
estimateAngle(x =base_barco$Lon,y = base_barco$Lat)
c4 <- estimateAngle(x =base_barco$Lon,y = base_barco$Lat)
cbind(c2,c3, c4)
c3
library(vmsR)
# registerDoSNOW(cl)
#
# cluster  = foreach(l = seq_along(listaBarco), .inorder = FALSE) %dopar% {
#   .getData2(listaBarco[[l]])
# }
# stopCluster(cl)
#
# for(w in seq_along(cluster)){
#   write.csv(cluster[[w]], file = paste0(directorio,"/",carpeta,"/",paste(cluster[[w]]$CODIGO[1], ".csv", sep = "")))
# }
require(vmsR)
base_barco <- data_vms[data_vms$Cod_Barco %in% unique(data_vms$Cod_Barco)[1],]
rumbo <- function(lon, lat, dist){
vector_rumbo <- NULL
for(i in 2:length(lon)){
rad <- pi/180
x2 <-  lon[i]*rad
y2 <-  lat[i]*rad
x1 <-  lon[i-1]*rad
y1 <-  lat[i-1]*ra
rum <- (90 - atan2(y2-y1,x2-x1) * 180/pi ) %% 360
vector_rumbo <- rbind(vector_rumbo, rum)
return(vector_rumbo)
}
c2 <- rumbo(lon = base_barco$Lon,lat = base_barco$Lat)
rumbo <- function(lon, lat, dist){
vector_rumbo <- NULL
for(i in 2:length(lon)){
rad <- pi/180
x2 <-  lon[i]*rad
y2 <-  lat[i]*rad
x1 <-  lon[i-1]*rad
y1 <-  lat[i-1]*ra
rum <- (90 - atan2(y2-y1,x2-x1) * 180/pi ) %% 360
vector_rumbo <- rbind(vector_rumbo, rum)
}
return(vector_rumbo)
}
c2 <- rumbo(lon = base_barco$Lon,lat = base_barco$Lat)
rumbo <- function(lon, lat){
vector_rumbo <- NULL
for(i in 2:length(lon)){
rad <- pi/180
x2 <-  lon[i]*rad
y2 <-  lat[i]*rad
x1 <-  lon[i-1]*rad
y1 <-  lat[i-1]*rad
rum <- (90 - atan2(y2-y1,x2-x1) * 180/pi ) %% 360
vector_rumbo <- rbind(vector_rumbo, rum)
}
return(vector_rumbo)
}
c2 <- rumbo(lon = base_barco$Lon,lat = base_barco$Lat)
c2
c1 <- calculate_course(lon = base_barco$Lon,lat = base_barco$Lat)
c1
cbind(c2, c1)
rumbo <- function(lon, lat){
vector_rumbo <- NULL
for(i in 2:length(lon)){
rad <- pi/180
x1 <-  lon[i]*rad
y1 <-  lat[i]*rad
x2 <-  lon[i-1]*rad
y2 <-  lat[i-1]*rad
rum <- (90 - atan2(y2-y1,x2-x1) * 180/pi ) %% 360
vector_rumbo <- rbind(vector_rumbo, rum)
}
return(vector_rumbo)
}
c2 <- rumbo(lon = base_barco$Lon,lat = base_barco$Lat)
c1 <- calculate_course(lon = base_barco$Lon,lat = base_barco$Lat)
cbind(c2, c1)
rumbo <- function(lon, lat){
vector_rumbo <- NULL
for(i in 2:length(lon)){
rad <- pi/180
x2 <-  lon[i]*rad
y2 <-  lat[i]*rad
x1 <-  lon[i-1]*rad
y1 <-  lat[i-1]*rad
rum <- (90 - atan2(y2-y1,x2-x1) * 180/pi ) %% 360
vector_rumbo <- rbind(vector_rumbo, rum)
}
return(vector_rumbo)
}
c1
rumbo <- function(lon, lat){
vector_rumbo <- NULL
for(i in 2:length(lon)){
rad <- pi/180
x2 <-  lon[i]*rad
y2 <-  lat[i]*rad
x1 <-  lon[i-1]*rad
y1 <-  lat[i-1]*rad
rum <- (90 - atan2(y2-y1,x2-x1) * 180/pi ) %% 360
vector_rumbo <- rbind(vector_rumbo, rum)
}
vector_rumbo <- c(NA, vector_rumbo)
return(vector_rumbo)
}
c2 <- rumbo(lon = base_barco$Lon,lat = base_barco$Lat)
c1 <- calculate_course(lon = base_barco$Lon,lat = base_barco$Lat)
cbind(c2, c1)
calculate_course
c2
c1
library(vmsR)
library(vmsR)
library(vmsR)
library(vmsR)
library(vmsR)
calculate_course <- function(lon,lat){
output <- NULL
for(i in 2:length(lon)){
rad <- pi/180
x2 <-  lon[i]*rad
y2 <-  lat[i]*rad
x1 <-  lon[i-1]*rad
y1 <-  lat[i-1]*rad
get_course <- (90 - atan2(y2-y1,x2-x1) * 180/pi ) %% 360
output <- rbind(output,get_course)
}
output <- c(NA, output)
# vectorRumbo <- NULL
# vectorRumbo[1] <- NA
# for(i in 2:length(lon)){
#   x2 <-  lon[i]
#   y2 <-  lat[i]
#   x1 <-  lon[i-1]
#   y1 <-  lat[i-1]
#   y   <- sin((x2-x1)*pi/180) * cos(y2*pi/180)
#   x   <- cos(y1*pi/180) * sin(y2*pi/180) - sin(y1*pi/180) * cos(y2*pi/180) * cos((x2-x1)*pi/180)
#   Rumbo <- atan2(y,x)*180/pi
#   Rumbo <- (Rumbo + 360)%%360
#   vectorRumbo <- rbind(vectorRumbo,Rumbo)
# }
# vectorRumbo <- as.vector(vectorRumbo)
# return(vectorRumbo)#, cambioRumbo = cambioRumbo))
return(vector_rumbo)
}
base_barco <- data_vms[data_vms$Cod_Barco %in% unique(data_vms$Cod_Barco)[1],]
#
# c2 <- rumbo(lon = base_barco$Lon,lat = base_barco$Lat)
c1 <- calculate_course(lon = base_barco$Lon,lat = base_barco$Lat)
#
# c2 <- rumbo(lon = base_barco$Lon,lat = base_barco$Lat)
c1 <- calculate_course(lon = base_barco$Lon,lat = base_barco$Lat)
calculate_course
calculate_course <- function(lon,lat){
output <- NULL
for(i in 2:length(lon)){
rad <- pi/180
x2 <-  lon[i]*rad
y2 <-  lat[i]*rad
x1 <-  lon[i-1]*rad
y1 <-  lat[i-1]*rad
get_course <- (90 - atan2(y2-y1,x2-x1) * 180/pi ) %% 360
output <- rbind(output,get_course)
}
output <- c(NA, output)
# vectorRumbo <- NULL
# vectorRumbo[1] <- NA
# for(i in 2:length(lon)){
#   x2 <-  lon[i]
#   y2 <-  lat[i]
#   x1 <-  lon[i-1]
#   y1 <-  lat[i-1]
#   y   <- sin((x2-x1)*pi/180) * cos(y2*pi/180)
#   x   <- cos(y1*pi/180) * sin(y2*pi/180) - sin(y1*pi/180) * cos(y2*pi/180) * cos((x2-x1)*pi/180)
#   Rumbo <- atan2(y,x)*180/pi
#   Rumbo <- (Rumbo + 360)%%360
#   vectorRumbo <- rbind(vectorRumbo,Rumbo)
# }
# vectorRumbo <- as.vector(vectorRumbo)
# return(vectorRumbo)#, cambioRumbo = cambioRumbo))
return(output)
}
#
# c2 <- rumbo(lon = base_barco$Lon,lat = base_barco$Lat)
c1 <- calculate_course(lon = base_barco$Lon,lat = base_barco$Lat)
c1
library(vmsR)
library(vmsR)
library(vmsR)
library(vmsR)
atan2
library(vmsR)
atan2
library(vmsR)
library(vmsR)
library(vmsR)
library(vmsR)
library(vmsR)
library(vmsR)
dist_ortodromica
