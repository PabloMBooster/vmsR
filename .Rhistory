index <- index_fleet(data_vms = dataSAT)
index
library(vmsR)
library(vmsR)
index_fleet
source('C:/pablo/D/github/vmsR/R/processing_vms.R')
library(vmsR)
distance_harbor
dist_ortodromica
idPuerto2
harbor
calculate_course
change_course
# Leer base de datos auxiliares
load("C:/Users/fenix/Downloads/PER_ADM0.RData")
plot(PER_ADMO)
plot(PER_ADM0)
str(PER_ADM0)
length(PER_ADM0@polygons)
PER_ADM0@polygons
str(PER_ADM0@polygons)
PER_ADM0@polygons::polygons
PER_ADM0@polygons:polygons
PER_ADM0@polygons:plotOrder
PER_ADM0@polygons:data
PER_ADM0@polygons[["data"]]
PER_ADM0@polygons["data"]
PER_ADM0@polygons
PER_ADM0@polygons[[22]]
names(PER_ADM0@polygons)
str(PER_ADM0@polygons)
names(PER_ADM0)
PER_ADM0@data
PER_ADM0@data$COD
names(PER_ADM0@polygons)
summary(PER_ADM0@polygons)
levels(PER_ADM0@polygons)
str(PER_ADM0@polygons)
PER_ADM0@polygons:polygons:polygons
PER_ADM0@polygons:proj4string
PER_ADM0@polygons@proj4string
summary(PER_ADM0@polygons)
str(PER_ADM0@polygons)
PER_ADM0@polygons[[1]]
PER_ADM0@polygons[[1]]@Polygons
PER_ADM0@polygons[[1]]@Polygons[[22]]
str(PER_ADM0@polygons[[1]]@Polygons[[22]])
PER_ADM0@polygons[[1]]@Polygons[[22]]@labpt
PER_ADM0@polygons[[1]]@Polygons[[22]]@labpt@coords
names(PER_ADM0@polygons[[1]]@Polygons[[22]]@labpt)
PER_ADM0@polygons[[1]]@Polygons[[22]]@labpt
PER_ADM0@polygons[[1]]@Polygons[[22]]@coords
plot(PER_ADM0@polygons[[1]]@Polygons[[22]]@coords)
peru_spatialPolygon <- PER_ADM0@polygons[[1]]@Polygons[[22]]@coords
class(peru_spatialPolygon)
class(PER_ADM0)
par(mfrow = 5,5, mar = c(0,0,0,0,))
for(i in 1:22){
plot(PER_ADM0@polygons[[1]]@Polygons[[i]]@coords, col = i)
}
par(mfrow = 5,5, mar = c(0,0,0,0))
for(i in 1:22){
plot(PER_ADM0@polygons[[1]]@Polygons[[i]]@coords, col = i)
}
par(mfrow = c(5,5), mar = c(0,0,0,0))
for(i in 1:22){
plot(PER_ADM0@polygons[[1]]@Polygons[[i]]@coords, col = i)
}
par(mfrow = c(5,5), mar = c(0,0,0,0))
for(i in 1:22){
plot(PER_ADM0@polygons[[1]]@Polygons[[i]]@coords, col = i, type = "l")
}
par(mfrow = c(5,5), mar = c(0,0,0,0))
for(i in 1:22){
plot(PER_ADM0@polygons[[1]]@Polygons[[i]]@coords, ylim = c(-21,-3), xlim = c(-84,-70)
col = i, type = "l")
}
par(mfrow = c(5,5), mar = c(0,0,0,0))
for(i in 1:22){
plot(PER_ADM0@polygons[[1]]@Polygons[[i]]@coords, ylim = c(-21,-3), xlim = c(-84,-70),
col = i, type = "l")
}
par(mfrow = c(5,5), mar = c(0,0,0,0))
for(i in 1:22){
plot(PER_ADM0@polygons[[2]]@Polygons[[i]]@coords, ylim = c(-21,-3), xlim = c(-84,-70),
col = i, type = "l")
}
PER_ADM0@polygons[[2]]
par(mfrow = c(5,5), mar = c(0,0,0,0))
for(i in 1:22){
plot(PER_ADM0@polygons[[1]]@Polygons[[i]]@coords, ylim = c(-21,-3), xlim = c(-84,-70),
col = i, type = "l")
}
str(PER_ADM0@polygons[[1]]@Polygons[[i]]@coords)
str(PER_ADM0@polygons[[1]]@Polygons[[]]@coords)
str(PER_ADM0@polygons[[1]]@Polygons[[1:22]]@coords)
str(PER_ADM0@polygons[[1]]@Polygons[[1]]@coords)
str(PER_ADM0@polygons[[1]]@Polygons[[2]]@coords)
str(PER_ADM0@polygons[[1]]@Polygons[[3]]@coords)
str(PER_ADM0@polygons[[1]]@Polygons[[4]]@coords)
str(PER_ADM0@polygons[[1]]@Polygons[[5]]@coords)
str(PER_ADM0@polygons[[1]]@Polygons[[6]]@coords)
str(PER_ADM0@polygons[[1]]@Polygons[[7]]@coords)
PER_ADM1 <- PER_ADM0@polygons[[1]]@Polygons#[[22]]@coords
str(PER_ADM1)
class(PER_ADM1)
PER_ADM0@data
PER_ADM0@plotOrder
PER_ADM0@plotOrder
PER_ADM0@bbox
PER_ADM0@proj4string
PER_ADM1 <- PER_ADM0#@polygons[[1]]@Polygons#[[22]]@coords
for(i in 1:22){
PER_ADM1@polygons[[1]]@Polygons[[i]]@coords <- NULL
}
PER_ADM1@polygons[[1]]@Polygons[[i]]@coords
PER_ADM1@polygons[[1]]@Polygons
PER_ADM1@polygons[[1]]@Polygons
PER_ADM1@polygons[[1]]@Polygons <- PER_ADM1@polygons[[1]]@Polygons[[22]]
PER_ADM1@polygons[[1]]@Polygons[[22]]
str(PER_ADM1@polygons[[1]]@Polygons[[22]])
PER_ADM1@polygons[[1]]@Polygons
PER_ADM1@polygons[[1]]@Polygons[[22]]
str(PER_ADM1@polygons[[1]]@Polygons)
PER_ADM1@polygons[[1]]@Polygons[[1]]
PER_ADM1@polygons[[1]]@Polygons[[1]] <- NULL
PER_ADM1@polygons[[1]]@Polygons[[1]]
PER_ADM1@polygons[[1]]@Polygons[[i]]
PER_ADM1@polygons[[1]]@Polygons
PER_ADM1@polygons[[1]]@Polygons <- NULL
class(PER_ADM1@polygons[[1]]@Polygons[[22]])
PER_ADM1@polygons[[1]]@Polygons[[22]]
PER_ADM1 <- PER_ADM0#@polygons[[1]]@Polygons#[[22]]@coords
PER_ADM1@polygons[[1]]@Polygons[[22]]
class( PER_ADM1@polygons[[1]]@Polygons[[22]])
PER_ADM1@polygons[[1]]@Polygons <- PER_ADM1@polygons[[1]]@Polygons[[22]]
PER_ADM1@polygons[[1]]@Polygons[[]]
PER_ADM1@polygons[[1]]@Polygons
PER_ADM0@polygons[[1]]@Polygons[[1]]
PER_ADM0@polygons[[1]]@Polygons[[1]]@coords
PER_ADM0@polygons[[1]]@Polygons[[1]]@coords[,1] <- NULL
PER_ADM0@polygons[[1]]@Polygons[[1]]@coords[,1] <- NA
PER_ADM0@polygons[[1]]@Polygons[[1]]@coords[,2] <- NA
PER_ADM0@polygons[[1]]@Polygons[[1]]@coords[,2]
PER_ADM0@polygons[[1]]@Polygons[[1]]@coords[,1]
class(PER_ADM0)
shp.subset <- PER_ADM0[i %in% 22,]
str(shp.subset)
plot(shp.subset)
plot(shp.subset)
shp.subset
PER_ADM0[, 22]
PER_ADM0[1, 22]
SpatialPolygonsDataFrame
SpatialPolygonsDataFrame(PER_ADM1@polygons[[1]]@Polygons[[22]])
PER_ADM1@polygons[[1]]@Polygons[[22]]
str(PER_ADM1@polygons[[1]]@Polygons[[22]])
PER_ADM1@polygons[[1]]@Polygons[[i]]@coords
PER_ADM1@polygons[[1]]@Polygons[[i]]@coords[,2]
#PER_ADM0@polygons[[1]]@Polygons[[22]]@coords
PER_ADM1 <- PER_ADM0
for(i in 1:22){
PER_ADM1@polygons[[1]]@Polygons[[i]]@coords[,1] <- -120
PER_ADM1@polygons[[1]]@Polygons[[i]]@coords[,2] <- -20
}
str(PER_ADM1)
save(PER_ADM1, file = "PER_ADM1.RData")
gewd()
getwd()
getwd()
library(vmsR)
ls(package:vmsR)
data_vms
dim(data_vms)
data_vms$Fecha_Matlab
format(data_vms$Fecha_Matlab,"%Y")
format(data_vms$Fecha_Matlab,formta = "%Y")
substring(data_vms$Fecha_Matlab1,4)
substring(data_vms$Fecha_Matlab, 1,4)
table(substring(data_vms$Fecha_Matlab, 1,4))
data_vms
head(data_vms)
data_vms$Cala
plot(data_vms$Lon_Obs_Ini_Cala, data_vms$Lat_Obs_Ini_Cala)
table(!is.na(data_vms$Cala))
data_vms[!is.na(data_vms$Cala), "Lon"]
data_vms[!is.na(data_vms$Cala), "Lon"][1]
data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"][1]
plot(data_vms[!is.na(data_vms$Cala), "Lon"][1], data_vms[!is.na(data_vms$Cala), "Lat"][1])
plot(data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"][1], data_vms[!is.na(data_vms$Cala), "Lat_Obs_Ini_Cala"][1], col = 2)
plot(data_vms[!is.na(data_vms$Cala), "Lon"][1], data_vms[!is.na(data_vms$Cala), "Lat"][1])
points(data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"][1], data_vms[!is.na(data_vms$Cala), "Lat_Obs_Ini_Cala"][1], col = 2)
plot(data_vms[!is.na(data_vms$Cala), "Lon"], data_vms[!is.na(data_vms$Cala), "Lat"], cex = 0.5)
points(data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"][1], data_vms[!is.na(data_vms$Cala), "Lat_Obs_Ini_Cala"][1], col = 2, cex = 0.5)
points(data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"], data_vms[!is.na(data_vms$Cala), "Lat_Obs_Ini_Cala"], col = 2, cex = 0.5)
plot(data_vms[!is.na(data_vms$Cala), "Lon"], data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"])
plot(data_vms[!is.na(data_vms$Cala), "Lat"], data_vms[!is.na(data_vms$Cala), "Lat_Obs_Ini_Cala"])
Dif <- data_vms[!is.na(data_vms$Cala), "Lon"] - data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"]
Dif
boxploot(Dif)
boxplot(Dif)
0.05*60
abline(h = c(0.025, -0.025), col = 2, lty = 2)
0.05*60
Dif
Dif
Dif
plot(data_vms[!is.na(data_vms$Cala), "Lon"], data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"])
plot(data_vms[!is.na(data_vms$Cala), "Lat"], data_vms[!is.na(data_vms$Cala), "Lat_Obs_Ini_Cala"])
Dif <- data_vms[!is.na(data_vms$Cala), "Lon"] - data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"]
Dif
Dif
Dif
Dif
Dif
data_vms[!is.na(data_vms$Cala), "Lon"]
data_vms[!is.na(data_vms$Cala), "R/velCol.R"]
names(data_vms)
data_vms[!is.na(data_vms$Cala), "Vel_Cal"]
hist(data_vms[!is.na(data_vms$Cala), "Vel_Cal"])
range(data_vms[!is.na(data_vms$Cala), "Vel_Cal"])
boxplot(data_vms[!is.na(data_vms$Cala), "Vel_Cal"])
Dif
Dif
Dif
names(data_vms)
1+1
names(data_vms)
head(data_vms)
data_vms$Pesca_Viaje
table(data_vms$Cod_Viaje_VMS)
length(table(data_vms$Cod_Viaje_VMS))
names(data_vms)
map_vms(data_vms$Lon[data_vms$Cod_Viaje_VMS == data_vms$Cod_Viaje_VMS[1]],
data_vms$Lat[data_vms$Cod_Viaje_VMS == data_vms$Cod_Viaje_VMS[1]],
data_vms$Vel_Cal[data_vms$Cod_Viaje_VMS == data_vms$Cod_Viaje_VMS[1]])
i = 2
map_vms(data_vms$Lon[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Lat[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i1]],
data_vms$Vel_Cal[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]])
i = 2
map_vms(data_vms$Lon[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Lat[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Vel_Cal[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]])
i = 3
map_vms(data_vms$Lon[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Lat[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Vel_Cal[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]])
i = 4
map_vms(data_vms$Lon[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Lat[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Vel_Cal[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]])
i = 5
map_vms(data_vms$Lon[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Lat[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Vel_Cal[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]])
pdf("mapas_bit_vms.pdf")
par(mfrow = c(5,5),mar = c(0,0,0,0), oma = c(0,0,0,0))
for(i in seq_along(unique(data_vms$Cod_Viaje_VMS)))
map_vms(data_vms$Lon[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Lat[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Vel_Cal[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]])
dev.off()
getwd()
pdf("mapas_bit_vms.pdf")
par(mfrow = c(5,5),mar = c(0,0,0,0), oma = c(0,0,0,0))
for(i in seq_along(unique(data_vms$Cod_Viaje_VMS)))
map_vms(data_vms$Lon[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Lat[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Vel_Cal[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]])
points(data_vms$Lon_Obs_Ini_Cala[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Lat_Obs_Ini_Cala[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]])
dev.off()
map_vms(data_vms$Lon[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Lat[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Vel_Cal[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]])
points(data_vms$Lon_Obs_Ini_Cala[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Lat_Obs_Ini_Cala[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]])
pdf("mapas_bit_vms.pdf")
par(mfrow = c(5,5),mar = c(0,0,0,0), oma = c(0,0,0,0))
for(i in seq_along(unique(data_vms$Cod_Viaje_VMS)))
map_vms(data_vms$Lon[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Lat[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Vel_Cal[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]])
points(data_vms$Lon_Obs_Ini_Cala[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Lat_Obs_Ini_Cala[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]], pch = 16, cex = 2)
dev.off()
for(i in seq_along(unique(data_vms$Cod_Viaje_VMS)))
map_vms(data_vms$Lon[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Lat[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Vel_Cal[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]])
map_vms(data_vms$Lon[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Lat[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Vel_Cal[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]])
points(data_vms$Lon_Obs_Ini_Cala[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Lat_Obs_Ini_Cala[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]], pch = 16, cex = 2)
pdf("mapas_bit_vms.pdf")
par(mfrow = c(5,5),mar = c(0,0,0,0), oma = c(0,0,0,0))
for(i in seq_along(unique(data_vms$Cod_Viaje_VMS)))
map_vms(data_vms$Lon[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Lat[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Vel_Cal[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]])
points(data_vms$Lon_Obs_Ini_Cala[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Lat_Obs_Ini_Cala[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]], pch = 16, cex = 2)
dev.off()
pdf("mapas_bit_vms.pdf")
par(mfrow = c(5,5),mar = c(0,0,0,0), oma = c(0,0,0,0))
for(i in seq_along(unique(data_vms$Cod_Viaje_VMS))){
map_vms(data_vms$Lon[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Lat[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Vel_Cal[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]])
points(data_vms$Lon_Obs_Ini_Cala[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]],
data_vms$Lat_Obs_Ini_Cala[data_vms$Cod_Viaje_VMS == unique(data_vms$Cod_Viaje_VMS)[i]], pch = 16, cex = 2)
}
dev.off()
#
# plot(data_vms[!is.na(data_vms$Cala), "Lon"], data_vms[!is.na(data_vms$Cala), "Lat"], cex = 0.5)
# points(data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"], data_vms[!is.na(data_vms$Cala), "Lat_Obs_Ini_Cala"], col = 2, cex = 0.5)
#
# plot(data_vms[!is.na(data_vms$Cala), "Lon"], data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"])
# plot(data_vms[!is.na(data_vms$Cala), "Lat"], data_vms[!is.na(data_vms$Cala), "Lat_Obs_Ini_Cala"])
# Dif <- data_vms[!is.na(data_vms$Cala), "Lon"] - data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"]
#
# ## entrenar un red solo con velocidades menores a dos
#
omit_trip <- data_vms[!is.na(data_vms$Cala) & data_vms$Vel_Cal < 2, "Cod_Viaje_VMS"]
#
# plot(data_vms[!is.na(data_vms$Cala), "Lon"], data_vms[!is.na(data_vms$Cala), "Lat"], cex = 0.5)
# points(data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"], data_vms[!is.na(data_vms$Cala), "Lat_Obs_Ini_Cala"], col = 2, cex = 0.5)
#
# plot(data_vms[!is.na(data_vms$Cala), "Lon"], data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"])
# plot(data_vms[!is.na(data_vms$Cala), "Lat"], data_vms[!is.na(data_vms$Cala), "Lat_Obs_Ini_Cala"])
# Dif <- data_vms[!is.na(data_vms$Cala), "Lon"] - data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"]
#
# ## entrenar un red solo con velocidades menores a dos
#
omit_trip <- unique(data_vms[!is.na(data_vms$Cala) & data_vms$Vel_Cal < 2, "Cod_Viaje_VMS"])
omit_trip
length(omit_trip)
data_vms$Cala
#
# plot(data_vms[!is.na(data_vms$Cala), "Lon"], data_vms[!is.na(data_vms$Cala), "Lat"], cex = 0.5)
# points(data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"], data_vms[!is.na(data_vms$Cala), "Lat_Obs_Ini_Cala"], col = 2, cex = 0.5)
#
# plot(data_vms[!is.na(data_vms$Cala), "Lon"], data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"])
# plot(data_vms[!is.na(data_vms$Cala), "Lat"], data_vms[!is.na(data_vms$Cala), "Lat_Obs_Ini_Cala"])
# Dif <- data_vms[!is.na(data_vms$Cala), "Lon"] - data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"]
#
# ## entrenar un red solo con velocidades menores a dos
#
omit_trip <- unique(data_vms[!is.na(data_vms$Cala) & data_vms$Vel_Cal < 2 & data_vms$Cala == 1, "Cod_Viaje_VMS"])
omit_trip
unique(data_vms$Cod_Viaje_VMS)
#
# plot(data_vms[!is.na(data_vms$Cala), "Lon"], data_vms[!is.na(data_vms$Cala), "Lat"], cex = 0.5)
# points(data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"], data_vms[!is.na(data_vms$Cala), "Lat_Obs_Ini_Cala"], col = 2, cex = 0.5)
#
# plot(data_vms[!is.na(data_vms$Cala), "Lon"], data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"])
# plot(data_vms[!is.na(data_vms$Cala), "Lat"], data_vms[!is.na(data_vms$Cala), "Lat_Obs_Ini_Cala"])
# Dif <- data_vms[!is.na(data_vms$Cala), "Lon"] - data_vms[!is.na(data_vms$Cala), "Lon_Obs_Ini_Cala"]
#
# ## entrenar un red solo con velocidades menores a dos
#
omit_trip <- unique(data_vms[!is.na(data_vms$Cala) & data_vms$Vel_Cal > 2 & data_vms$Cala == 1, "Cod_Viaje_VMS"])
omit_trip
data_vms = data_vms[!data_vms$Cod_Viaje_VMS %in% omit_trip,]
hist(data_vms$Vel_Cal[!is.na(data_vms$Cala)])
rm(data_vms)
data_vms
dim(data_vms)
hist(data_vms$Vel_Cal[!is.na(data_vms$Cala)])
hist(data_vms2$Vel_Cal[!is.na(data_vms2$Cala)])
data_vms2 = data_vms[!data_vms$Cod_Viaje_VMS %in% omit_trip,]
hist(data_vms2$Vel_Cal[!is.na(data_vms2$Cala)])
dim(data_vms2)
dim(data_vms)
pdf("mapas_bit_vms.pdf")
par(mfrow = c(5,5),mar = c(0,0,0,0), oma = c(0,0,0,0))
for(i in seq_along(unique(data_vms2$Cod_Viaje_VMS))){
map_vms(data_vms2$Lon[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]],
data_vms2$Lat[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]],
data_vms2$Vel_Cal[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]])
points(data_vms2$Lon_Obs_Ini_Cala[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]],
data_vms2$Lat_Obs_Ini_Cala[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]], pch = 16, cex = 2)
}
dev.off()
pdf("mapas_bit_vms.pdf")
par(mfrow = c(5,5),mar = c(0,0,0,0), oma = c(0,0,0,0))
for(i in seq_along(unique(data_vms2$Cod_Viaje_VMS))){
map_vms(data_vms2$Lon[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]],
data_vms2$Lat[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]],
data_vms2$Vel_Cal[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]])
points(data_vms2$Lon_Obs_Ini_Cala[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]],
data_vms2$Lat_Obs_Ini_Cala[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]], pch = 16, cex = 2)
legend("toprigh", legend = data_vms2$Cod_Viaje_VMS[1], bty = "n")
}
dev.off()
pdf("mapas_bit_vms.pdf")
par(mfrow = c(5,5),mar = c(0,0,0,0), oma = c(0,0,0,0))
for(i in seq_along(unique(data_vms2$Cod_Viaje_VMS))){
map_vms(data_vms2$Lon[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]],
data_vms2$Lat[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]],
data_vms2$Vel_Cal[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]])
points(data_vms2$Lon_Obs_Ini_Cala[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]],
data_vms2$Lat_Obs_Ini_Cala[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]], pch = 16, cex = 2)
legend("toprigh", legend = data_vms2$Cod_Viaje_VMS[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]][1], bty = "n")
}
dev.off()
pdf("mapas_bit_vms.pdf")
par(mfrow = c(5,5),mar = c(0,0,0,0), oma = c(0,0,0,0))
for(i in seq_along(unique(data_vms2$Cod_Viaje_VMS))){
map_vms(data_vms2$Lon[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]],
data_vms2$Lat[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]],
data_vms2$Vel_Cal[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]])
points(data_vms2$Lon_Obs_Ini_Cala[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]],
data_vms2$Lat_Obs_Ini_Cala[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]], pch = 16, cex = 2)
legend("toprigh", legend = data_vms2$Cod_Viaje_VMS[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]][1], bty = "n", col = 4)
}
dev.off()
pdf("mapas_bit_vms.pdf")
par(mfrow = c(5,5),mar = c(0,0,0,0), oma = c(0,0,0,0))
for(i in seq_along(unique(data_vms2$Cod_Viaje_VMS))){
map_vms(data_vms2$Lon[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]],
data_vms2$Lat[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]],
data_vms2$Vel_Cal[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]])
points(data_vms2$Lon_Obs_Ini_Cala[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]],
data_vms2$Lat_Obs_Ini_Cala[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]], pch = 16, cex = 2)
legend("toprigh", legend = data_vms2$Cod_Viaje_VMS[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]][1], bty = "n", bg = 4)
}
dev.off()
pdf("mapas_bit_vms.pdf")
par(mfrow = c(5,5),mar = c(0,0,0,0), oma = c(0,0,0,0))
for(i in seq_along(unique(data_vms2$Cod_Viaje_VMS))){
map_vms(data_vms2$Lon[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]],
data_vms2$Lat[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]],
data_vms2$Vel_Cal[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]])
points(data_vms2$Lon_Obs_Ini_Cala[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]],
data_vms2$Lat_Obs_Ini_Cala[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]], pch = 16, cex = 2)
legend("toprigh", legend = data_vms2$Cod_Viaje_VMS[data_vms2$Cod_Viaje_VMS == unique(data_vms2$Cod_Viaje_VMS)[i]][1], bty = "n", text.col = 4)
}
dev.off()
data_vms2 = data_vms2[!data_vms2$Cod_Viaje_VMS %in% c(10599,10332,10413,10195,10471,10245,
10257,10202,10772,10771,9901,10576,
10585), ]
hist(data_vms2$Vel_Cal[!is.na(data_vms2$Cala)])
head(data_vms2)
head(data_vms2)
require(vmsR)
head(data_vms)
require(vmsR)
data_vms$Rumbo_VMS
data_vms$Rumbo_VMS[data_vms$Cala == 1]
data_vms$Cambio_Rumbo_Calc[data_vms$Cala == 1]
data_vms$Cambio_Rumbo_Calc[data_vms$Cala == 1 & is.na(data_vms$Cala)]
data_vms$Cambio_Rumbo_Calc[data_vms$Cala == 1 & !is.na(data_vms$Cala)]
par(mfrow = c(2,1))
hist(data_vms$Cambio_Rumbo_Calc[data_vms$Cala == 1 & !is.na(data_vms$Cala)])
hist(data_vms$Cambio_Rumbo_Calc[data_vms$Cala != 1 & !is.na(data_vms$Cala)])
hist(data_vms$Cambio_Rumbo_Calc[data_vms$Cala == 0 & !is.na(data_vms$Cala)])
hist(data_vms$Cambio_Rumbo_Calc[data_vms$Cala == 0])
data_vms$Cambio_Rumbo_Calc[data_vms$Cala == 0]
data_vms$Cambio_Rumbo_Calc
table(is.na(data_vms$Cambio_Rumbo_Calc))
head(data_vms)
View(data_vms)
table(data_vms$Cala)
summary(data_vms$Cala)
data_vms$Cala[!is.na(data_vms$Cala)]
data_vms$Cambio_Rumbo_Calc[!is.na(data_vms$Cala)]
par(mfrow = c(2,1))
hist(data_vms$Cambio_Rumbo_Calc[!is.na(data_vms$Cala)])
hist(data_vms$Cambio_Rumbo_Calc[is.na(data_vms$Cala)])
head(data_vms)
calculate_course(data_vms$Lon, data_vms$Lat)
course <- calculate_course(data_vms$Lon, data_vms$Lat)
data_vms$diff_course <- c(NA, diff(course))
data_vms$diff_course
boxplot(data_vms)
boxplot(data_vms$diff_course)
levels(data_vms$Cala)
data_vms$Cala
data_vms$Cala[is.na(data_vms$Cala)]
data_vms$Cala[is.na(data_vms$Cala)] <- 0
boxplot(data_vms$diff_course ~ data_vms$Cala)
boxplot(data_vms$diff_course ~ data_vms$Cala)
boxplot(data_vms$diff_course ~ data_vms$Cala, outline = F)
data_vms$diff_course <- c(0, abs(diff(course)))
data_vms$diff_course
par(mfrow = c(2,1))
hist(data_vms$diff_course[data_vms$Cala == 0])
hist(data_vms$diff_course[data_vms$Cala == 1])
par(mfrow = c(2,1))
hist(data_vms$diff_course[data_vms$Cala == 0], xlim = c(0,400))
hist(data_vms$diff_course[data_vms$Cala == 1], xlim = c(0,400))
par(mfrow = c(2,1))
hist(data_vms$diff_course[data_vms$Cala == 0], xlim = c(0,400))
hist(data_vms$diff_course[which(data_vms$Cala == 1)+1], xlim = c(0,400))
par(mfrow = c(2,1))
hist(data_vms$diff_course[data_vms$Cala == 0], xlim = c(0,400))
hist(data_vms$diff_course[which(data_vms$Cala == 1)-1], xlim = c(0,400))
head(data_vms)
hist(data_vms$Vel_VMS)
hist(data_vms$Vel_Cal)
hist(data_vms$Vel_Cal, xlim = c(0,20))
data_vms$Vel_Cal
boxplot(data_vms$Vel_Cal)
boxplot(data_vms$Vel_Cal, outline = F)
summary(data_vms$Vel_Cal)
sort(data_vms$Vel_Cal, decreasing = T)[1:10]
sort(data_vms$Vel_Cal, decreasing = T)[1:20]
sort(data_vms$Vel_Cal, decreasing = T)[1:50]
sort(data_vms$Vel_Cal, decreasing = T)[1:100]
